import {useDispatch, useSelector} from "react-redux";
import {Link, useNavigate} from "react-router-dom";
import {AuthService} from "../../services/AuthService";
import {logout, setAuth} from "../../actions";
import {localStorageKeyAuth} from "../../utils/constants";

const Header = () => {
    const {curUser, isAuth} = useSelector(state => state)
    const navigate = useNavigate()
    const dispath = useDispatch()

    const authApi = new AuthService()

    return (<div className={"body-container header-container"}>
        <div> <Link to={'/'}>
            LOGO
        </Link></div>
        {isAuth ?
            <div>
                <Link to={'/profile'}>
                    Добрый день, {curUser.identity}
                </Link>
                <button onClick={async () => {
                    await authApi.logout()
                    localStorage.removeItem(localStorageKeyAuth)
                    dispath(setAuth(false))
                }}>
                    Выйти
                </button>
            </div>
                :
            <div>
                    <button onClick={() => navigate("/auth")}>
                        Войти
                    </button>
                    <button onClick={() => navigate("/registration")}>
                        Зарегистрироваться
                    </button>
            </div>}
    </div>)
}

export default Header
