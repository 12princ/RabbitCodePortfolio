const encryptService = require('../services/encryptionService')

// Шифрование данных на пути к клиенту
module.exports = function (req, res, next) {
    const originalSend = res.send;
    res.send = function (body) {
        let nBody = body
        if (typeof body === "string" && body.includes("errors") && body.includes("message")) {
            nBody = JSON.parse(body)
        }
        const encryptedData = encryptService.encrypt({value: nBody})
        originalSend.call(this, encryptedData);
    };
    next();
}